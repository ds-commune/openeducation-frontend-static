## 1. Цель миграции

Когда мы говорим «мигрировать страницу/компонент на Skeleton UI» в этом проекте, это означает:

1. **Привести разметку к архитектуре курса**  
   - Страница живёт в `src/routes/courses/math/...`, рендерится через `math/+layout.svelte` (sidebar + bottom-nav).
   - Внутри `+page.svelte` — набор `<section id="...">` с осмысленными id.

2. **Перевести визуал на дизайн‑систему Skeleton**  
   - Фоны, градиенты, бордеры, радиусы, тени — на токенах Skeleton (`--color-*`, `--radius-*`, и т.д.).
   - Никаких зависимостей от Shoelace (`--sl-*`) и Tailwind‑классов.

3. **Заменить самодельные блоки на готовые паттерны**  
   - Используем `Crisis`, `DefinitionCard`, `TakeawayCard`, `Summary`, `QuizCard`, `VisualBreak` и т.п.

4. **Навести порядок в CSS и в области видимости**  
   - Весь CSS секции зашит под `#section-id { ... }`.
   - В компонентах — корневой класс + `:global` только под ним.
   - Группируем модификаторы через `&.modifier` внутри базового селектора.

---

## 2. Дизайн‑токены: только Skeleton, Shoelace вычищаем

### 2.1. Цветовые токены Skeleton

Используем **только** токены Skeleton из темы (и их fallbacks):

- Основная палитра:
  - `--color-primary-50/100/200/.../900`
- Семантика:
  - `--color-success-*`, `--color-warning-*`, `--color-error-*`
- Поверхности/серый:
  - `--color-surface-*`

Пример (как уже в `definition-card`):

````css path=src/routes/courses/math/definition-card.svelte mode=EXCERPT
.container {
  background: var(--color-primary-50, #e8f5e9);
  border-radius: calc(var(--radius-container, 0.25rem) * 4);
}
````

**Правило:**  
Если нужен новый цвет/оттенок — сначала пробуем подобрать из `--color-*`. Если совсем не подходит:

- Берём **фиксированный hex** (можно смотреть на Tailwind‑палитру, но значение пишем как `#...`),  
- Заворачиваем его как fallback в `var(--color-..., #hex)`.

### 2.2. Что делать с `--sl-*`

При миграции:

- **Любой `--sl-color-*` → соответствующий `--color-*` из Skeleton.**
  - Было: `background: var(--sl-color-neutral-50);`  
    Станет: `background: var(--color-surface-50, #f8f9fa);`
- **`--sl-border-radius-*` → `--radius-*`/`--radius-container`.**
  - Было: `border-radius: var(--sl-border-radius-large, 1rem);`  
    Станет: `border-radius: calc(var(--radius-container, 0.25rem) * 4);`
- **`--sl-shadow-*` → своя тень через `color-mix` (см. ниже).**

То есть любой след `--sl-` в проекте — это точка миграции.

### 2.3. Тени

Для «глубоких» карточек (кризис, определения, summary, пример‑карты):

````css mode=EXCERPT
box-shadow: 0 12px 32px
  color-mix(in oklab, var(--color-surface-900) 0.12, transparent);
````

Если раньше было `var(--sl-shadow-small)`, переписываем на один из таких вариантов:

- Лёгкая тень: уменьшить смещение/прозрачность.
- Глубокая тень: как в примере выше.

---

## 3. Tailwind: можно смотреть, но нельзя использовать

Tailwind в проекте есть, но **он служит только для Skeleton** (под капотом). Для нас правила:

1. **Запрещено:**
   - `class="flex gap-4 px-6 ..."` и любые другие Tailwind‑классы в шаблонах.
   - `@apply flex gap-4 ...` в `<style>`.
   - Любые прямые зависимости от tailwind‑переменных или `theme()`.

2. **Разрешено:**
   - Ориентироваться на Tailwind‑шкалы **как на справочник** при выборе rem‑значений и цветов.  
     Например: знаем, что `tailwind md` ~ `0.875rem`, `xl` ~ `1.25rem` и т.д., но в проекте пишем просто `font-size: 1.25rem;`.

3. **Практический принцип:**  
   - **Пишем чистый CSS + Skeleton‑токены.**  
   - Если чего-то нет в Skeleton — берём числовые значения (rem/px, hex) вручную, без Tailwind‑магии.

---

## 4. Типографика и отступы

Здесь в целом всё как в предыдущем гайде, но без `--sl-*`.

### 4.1. Глобальная типографика (из `+layout.svelte`)

- Не трогаем глобальные:
  - `p`, `h2`, `h3`, `h4`, `section`.
- Они уже заданы под бренд:
  - `p`: `1.375rem`, `margin-bottom: 1.75rem;`
  - `h2`: `1.75rem`, `margin-bottom: 1.5rem;` и т.д.

**Правило:**  
В уроках не переопределяем эти теги глобально. Только scoped‑правила.

### 4.2. Внутри карточек / специальных блоков

В компонентах:

- Общий текст внутри карточек:
  - `font-size: 1.25rem;`
- Подписи/лейблы:
  - `font-size: 1.05rem;` или `0.9rem` (например `.label` в `definition-card`).
- Межабзацные отступы:
  - Обнуляем дефолт и задаём свои, как ты уже сделал:

````css path=src/routes/courses/math/definition-card.svelte mode=EXCERPT
.container :global {
  p { margin: 0; }
  p + p { margin-top: 1rem; }
}
````

- Внешние отступы карточек от текста:
  - Как правило: `margin: 2rem 0;` или `margin-top: 2rem;` / `3rem;`.

### 4.3. Запрет на старые токены

- Не используем `var(--spacing-*)`, `var(--text-*)` в новых/мигрируемых стилях.
- Там, где они были, — заменяем на конкретные `rem` (как ты уже сделал: `2.5rem`, `1.5rem`, `1.25rem` и т.п.).

---

## 5. Компоненты‑паттерны и их миграция

Сами компоненты тоже должны быть «чистыми» от Shoelace и Tailwind.

### 5.1. Crisis

- Используем для кризисных вступлений.
- Внутри:
  - `background: linear-gradient(...var(--color-warning-100)...);`
  - Крупная иконка, заголовок, блок вопроса на `--color-surface-100`.

Правила миграции:
- Любые старые цвета/тени → на `--color-warning-*` + скелетон‑тень.

### 5.2. DefinitionCard

- Используем для формальных определений.
- Уже использует Skeleton‑токены (`--color-primary-*`, `--radius-container`).

Правила миграции:
- Все определения переписываем через этот компонент. Не плодим новые «локальные» версии дефинишн‑карточек.

### 5.3. Summary

- Используем для итоговой мысли.
- Градиент на `--color-primary-*`.

Правила миграции:
- Любые «итоговые» блоки в уроке сводим к `<Summary>`;  
- Фон/бордеры — только через `--color-primary-*`.

### 5.4. TakeawayCard

- Используем для выводов/«битов информации».
- Если внутри сейчас остались `--sl-*` — при миграции:
  - `--sl-color-primary-50` → `--color-primary-50`,
  - `--sl-border-radius-large` → `calc(var(--radius-container) * 4)`.

### 5.5. QuizCard и VisualBreak

- Сейчас части их стилей завязаны на `--sl-*` (по коду это видно).
- При миграции:
  - Все `--sl-color-neutral-*` → `--color-surface-*`.
  - Все радиусы/тени → Skeleton‑паттерны (см. выше).
  - Tailwind‑классов (если вдруг попадутся) быть не должно.

---

## 6. Scope CSS: секции, компоненты и глубина селекторов

### 6.1. Секции страницы (`+page.svelte`)

**Золотое правило: одна секция — один блок CSS под её id.**

Например (упрощённо для `#unambiguity-test`):

````css path=src/routes/courses/math/level-1/lesson-1/+page.svelte mode=EXCERPT
#unambiguity-test {
  .example-cards { ... }
  .example-cards .card {
    ...
    &.opinion { ... }
    &.statement { ... }
  }
}
````

Особенности:

- Все внутренние классы (`.example-cards`, `.card`, `.phrase`, `.label`, `.opinion`, `.statement`) живут **только внутри `#unambiguity-test { ... }`**.
- Модификаторы (`.opinion`, `.statement`) оформляем через `&.opinion` / `&.statement` **внутри блока `.card`**, а не отдельными «висящими» `.card.opinion` снаружи. Это как раз та правка, которую ты сделал.

**Чего не делаем:**

- Не пишем голые `.example-cards { ... }` вне `#unambiguity-test`.
- Не пишем глобальные `p { ... }`, `h2 { ... }`, `blockquote { ... }` в `+page.svelte`.

### 6.2. Компоненты

Правило: **корневой класс + локальный `:global`**.

- Корневой контейнер: `.container`, `.crisis`, `.summary`, `.content` и т.п.
- Любое управление тегами потомков — только через:

````css path=src/routes/courses/math/takeaway-card.svelte mode=EXCERPT
.content :global {
  p { margin: 0; }
  p + p { margin-top: 0.75rem; }
}
````

- Не делаем `:global(p) { ... }` в корне `<style>`.

---

## 7. Адаптивность

Брейкпоинты:

- `@media (max-width: 1100px)` — основной:
  - sidebar → одноколоночный,
  - карточки могут переходить из row в column.
- `@media (max-width: 700px)` — тонкие правки:
  - уменьшаем паддинги,
  - немного уменьшаем иконки,
  - ужимаем gap‑ы.

**При миграции:**

- Если в старой версии были другие брейкпоинты — приводим к этим двум, если только нет очень специального кейса.

---

## 8. Краткий чек‑лист миграции с учётом Shoelace/Tailwind

1. **Разметка**
   - Страница встроена в `math/+layout.svelte`.
   - Контент разбит на `<section id="...">`.

2. **Компоненты‑паттерны**
   - Кризис → `<Crisis>`.
   - Определения → `<DefinitionCard>`.
   - Итоги → `<Summary>`.
   - Выводы → `<TakeawayCard>`.
   - Вопросы с ответами → `<QuizCard>`.
   - Широкие иллюстрации → `<VisualBreak>`.

3. **Shoelace**
   - В коде нет `--sl-*`.
   - Всё, что было на Shoelace‑токенах, переписано на `--color-*`, `--radius-*`, свои `box-shadow`.

4. **Tailwind**
   - В разметке нет ни одного Tailwind‑класса (`flex`, `gap-4`, `mt-6`, и т.д.).
   - В стилях нет `@apply` и tailwind‑специфичных конструкций.
   - Значения размеров/цветов — обычные CSS + Skeleton‑токены; Tailwind — только как справочник в голове.

5. **Типографика и отступы**
   - Нет `var(--spacing-*)` / `var(--text-*)`.
   - Внутри карточек свои правила для `p`, `p + p`.

6. **CSS‑scope**
   - Для каждой секции есть `#section-id { ... }` с полной глубиной.
   - В компонентах — корневой класс, вложенные модификаторы через `&.modifier`.

7. **Адаптив**
   - Проверены 1100px и 700px; вёрстка не ломается.
