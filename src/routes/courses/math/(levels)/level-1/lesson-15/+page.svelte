<script lang="ts">
  import { Crisis, QuizCard, Section, Summary } from "../../components";

  // Building height calculator
  let floors = $state(8);
  const floorHeight = 3;
  const roofHeight = 2;
  const foundationDepth = 3;
  const totalHeight = $derived(
    floorHeight * floors + roofHeight + foundationDepth
  );

  function getPluralFloor(n: number): string {
    const lastDigit = n % 10;
    const lastTwoDigits = n % 100;

    if (lastTwoDigits >= 11 && lastTwoDigits <= 14) {
      return "—ç—Ç–∞–∂–µ–π";
    }
    if (lastDigit === 1) {
      return "—ç—Ç–∞–∂";
    }
    if (lastDigit >= 2 && lastDigit <= 4) {
      return "—ç—Ç–∞–∂–∞";
    }
    return "—ç—Ç–∞–∂–µ–π";
  }

  // Formula translator demo
  let selectedFormula = $state<"add" | "multiply" | "subtract">("add");
  let variableValue = $state(7);
  const formulaResult = $derived(() => {
    if (selectedFormula === "add") return variableValue + 2;
    if (selectedFormula === "multiply") return variableValue * 2;
    if (selectedFormula === "subtract") return variableValue - 4;
    return variableValue;
  });

  // Dictionary items
  const dictionary = [
    { phrase: "¬´–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —á–∏—Å–ª–æ¬ª", symbol: "x", desc: "–ª—é–±–∞—è –±—É–∫–≤–∞" },
    { phrase: "¬´—É–≤–µ–ª–∏—á–∏–ª–∏ –Ω–∞...¬ª", symbol: "+", desc: "—Å–ª–æ–∂–µ–Ω–∏–µ" },
    { phrase: "¬´—É–º–µ–Ω—å—à–∏–ª–∏ –Ω–∞...¬ª", symbol: "‚àí", desc: "–≤—ã—á–∏—Ç–∞–Ω–∏–µ" },
    { phrase: "¬´—É–≤–µ–ª–∏—á–∏–ª–∏ –≤... —Ä–∞–∑¬ª", symbol: "¬∑", desc: "—É–º–Ω–æ–∂–µ–Ω–∏–µ" },
    { phrase: "¬´—Ä–∞–∑–¥–µ–ª–∏–ª–∏ –Ω–∞ –≥—Ä—É–ø–ø—ã¬ª", symbol: ":", desc: "–¥–µ–ª–µ–Ω–∏–µ" },
  ];
</script>

<svelte:head>
  <meta
    name="description"
    content="–£—Ä–æ–∫ –æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–∞–∫ –∏–º–µ–Ω–∞—Ö –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω. –£—á–∏–º—Å—è –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞."
  />
</svelte:head>

<!-- Crisis Section -->
<Section id="crisis">
  <Crisis icon="üèóÔ∏è" title="–ü—Ä–æ–±–ª–µ–º–∞ –ª–µ–Ω–∏–≤–æ–≥–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞">
    <p>
      –í—ã ‚Äî –≥–ª–∞–≤–Ω—ã–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –≥–æ—Ä–æ–¥–∞ –±—É–¥—É—â–µ–≥–æ. –ú—ç—Ä–∏—è –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Å—Ç—Ä–∞–Ω–Ω–æ–µ
      —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: ¬´–ú—ã –ø–æ–∫–∞ –Ω–µ –∑–Ω–∞–µ–º, —Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–∂–µ–π –±—É–¥–µ—Ç –≤ –¥–æ–º–µ ‚Äî —ç—Ç–æ
      –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–π–æ–Ω–∞. –ù–æ –º—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º: –∫—Ä—ã—à–∞ –≤—Å–µ–≥–¥–∞ –Ω–∞ 2 –º–µ—Ç—Ä–∞ –≤—ã—à–µ
      –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç—Ç–∞–∂–∞, –∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç —É—Ö–æ–¥–∏—Ç –Ω–∞ 3 –º–µ—Ç—Ä–∞ –≤–≥–ª—É–±—å¬ª.
    </p>

    <div class="calculations">
      <div class="row">
        <span class="label">5 —ç—Ç–∞–∂–µ–π:</span>
        <span class="formula">3 ¬∑ 5 + 2 + 3 = 20 –º</span>
      </div>
      <div class="row">
        <span class="label">10 —ç—Ç–∞–∂–µ–π:</span>
        <span class="formula">3 ¬∑ 10 + 2 + 3 = 35 –º</span>
      </div>
      <div class="row problem">
        <span class="label">??? —ç—Ç–∞–∂–µ–π:</span>
        <span class="formula">???</span>
      </div>
    </div>

    <blockquote>
      –í —Å–∏—Å—Ç–µ–º—É ¬´–ø—Ä–∏–ª–µ—Ç–∞–µ—Ç¬ª 10 000 –∑–∞—è–≤–æ–∫ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤. –ó–∞–∫–∞–∑—á–∏–∫ —Ç—Ä–µ–±—É–µ—Ç <strong
        >–æ–¥–Ω—É</strong
      >
      —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è —Ä–æ–±–æ—Ç–∞-—Å—Ç—Ä–æ–∏—Ç–µ–ª—è, –∞ –Ω–µ 10 000 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
    </blockquote>

    {#snippet question()}
      <p>
        <strong>–í–æ–ø—Ä–æ—Å:</strong> –∫–∞–∫ –∑–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, –µ—Å–ª–∏ –º—ã –Ω–µ –∑–Ω–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ
        —á–∏—Å–ª–æ, –Ω–æ —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º –ø—Ä–∞–≤–∏–ª–∞?
      </p>
    {/snippet}
  </Crisis>
</Section>

<!-- Meaning Container -->
<Section
  id="meaning-container"
  title="–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–º—ã—Å–ª–∞"
  description="–ú—ã –Ω–µ –º–æ–∂–µ–º –∑–∞–ø–∏—Å–∞—Ç—å —á–∏—Å–ª–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è. –ù–æ –º—ã –º–æ–∂–µ–º –ø–æ—Å—Ç–∞–≤–∏—Ç—å ¬´–∫–æ—Ä–æ–±–∫—É¬ª ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ç–æ–º —É–ø–∞–¥–µ—Ç –Ω—É–∂–Ω–æ–µ —á–∏—Å–ª–æ. –í –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ –º—ã –¥–∞–µ–º –∏–º—è –Ω–µ —Å–∞–º–æ–º—É —á–∏—Å–ª—É, –∞ —Ä–æ–ª–∏, –∫–æ—Ç–æ—Ä—É—é —ç—Ç–æ —á–∏—Å–ª–æ –∏–≥—Ä–∞–µ—Ç."
>
  <div class="conveyor">
    <div class="box labeled">
      <span class="label">–í—ã—Å–æ—Ç–∞ —ç—Ç–∞–∂–∞</span>
      <span class="value">3</span>
    </div>
    <div class="box labeled">
      <span class="label">–ö—Ä—ã—à–∞</span>
      <span class="value">2</span>
    </div>
    <div class="box empty">
      <span class="label">–ö–æ–ª-–≤–æ —ç—Ç–∞–∂–µ–π</span>
      <span class="value">?</span>
      <span class="sticker">üì¶</span>
    </div>
  </div>

  <div class="insight">
    –ü–æ–∫–∞ –º—ã –Ω–µ –∑–Ω–∞–µ–º —á–∏—Å–ª–æ, –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å <strong>–Ω–∞–∫–ª–µ–π–∫–æ–π</strong> (—è—Ä–ª—ã–∫–æ–º). –≠—Ç–æ
    –æ–±–µ—â–∞–Ω–∏–µ: ¬´—Å—é–¥–∞ –ø—Ä–∏–¥–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∑–∂–µ¬ª.
  </div>
</Section>

<!-- Box to Symbol -->
<Section
  id="box-to-symbol"
  title="–û—Ç –∫–æ—Ä–æ–±–∫–∏ –∫ —Å–∏–º–≤–æ–ª—É"
  description="–†–∏—Å–æ–≤–∞—Ç—å –∫–æ—Ä–æ–±–∫–∏ –¥–æ–ª–≥–æ. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∏ ‚Äî –ª—é–¥–∏ –ª–µ–Ω–∏–≤—ã–µ (—á–∏—Ç–∞–π: —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ). –í–º–µ—Å—Ç–æ —Ä–∏—Å—É–Ω–∫–∞ –∫–æ—Ä–æ–±–∫–∏ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±—É–∫–≤—É. –ü—É—Å—Ç—å ¬´–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Ç–∞–∂–µ–π¬ª = n."
>
  <div class="distillation">
    <div class="card reality">
      <div class="header">
        <span class="icon">üó£Ô∏è</span>
        <span class="title">–ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —è–∑—ã–∫</span>
      </div>
      <div class="content">
        ¬´–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –≤—ã—Å–æ—Ç—É, –Ω—É–∂–Ω–æ –≤–∑—è—Ç—å <strong>3 –º–µ—Ç—Ä–∞</strong> –Ω–∞ –∫–∞–∂–¥—ã–π –∏–∑
        —ç—Ç–∞–∂–µ–π, –∞ –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–∏—Ç—å <strong>5 –º–µ—Ç—Ä–æ–≤</strong> (–∫—Ä—ã—à–∞ + —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç)¬ª
      </div>
    </div>

    <div class="connector">
      <div class="arrow-group">
        <div class="line"></div>
        <div class="tip">‚ñº</div>
      </div>
      <div class="badge">–°–∂–∞—Ç–∏–µ —Å–º—ã—Å–ª–∞</div>
    </div>

    <div class="card math">
      <div class="header">
        <span class="icon">üíé</span>
        <span class="title">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</span>
      </div>
      <div class="content">
        <span class="token">3</span><span class="token var">n</span>
        <span class="token op">+</span>
        <span class="token">5</span>
      </div>
    </div>
  </div>

  <p>
    –ü–æ—á–µ–º—É –º—ã —á–∞—Å—Ç–æ –æ–ø—É—Å–∫–∞–µ–º –∑–Ω–∞–∫ —É–º–Ω–æ–∂–µ–Ω–∏—è (<span class="math-formula">3n</span
    >
    –≤–º–µ—Å—Ç–æ
    <span class="math-formula">3 ¬∑ n</span>)? –î–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏.
    –°–ª–∏—Ç–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É–µ—Ç –µ–¥–∏–Ω—ã–π –æ–±—ä–µ–∫—Ç ‚Äî –∫–∞–∫ ¬´—Ç—Ä–∏ —ç—Ç–∞–∂–∞¬ª –∑–≤—É—á–∏—Ç
    —Å–ª–∏—Ç–Ω–æ.
  </p>
</Section>

<!-- Building Calculator -->
<Section
  id="building-calculator"
  title="–ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º—É–ª—É"
  description="–ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Ç–∞–∂–µ–π –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–¥–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤."
>
  <div class="demo">
    <div class="input-group">
      <label for="floors-input"
        >–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Ç–∞–∂–µ–π (<span class="math-var">n</span>):</label
      >
      <div class="range-wrapper">
        <input
          id="floors-input"
          type="range"
          bind:value={floors}
          min="1"
          max="20"
          aria-label="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Ç–∞–∂–µ–π"
        />
        <span class="value-badge">{floors}</span>
      </div>
    </div>

    <div class="visual">
      <div class="part roof">üè† –ö—Ä—ã—à–∞: +{roofHeight} –º</div>
      <div class="part floors" style="--floor-count: {floors}">
        <span class="icon">üè¢</span>
        <span>
          {floors}
          {getPluralFloor(floors)} √ó {floorHeight} –º = {floors * floorHeight} –º
        </span>
      </div>
      <div class="part foundation">‚¨áÔ∏è –§—É–Ω–¥–∞–º–µ–Ω—Ç: +{foundationDepth} –º</div>
    </div>

    <div class="result">
      <div class="formula-display">
        <span class="label">–§–æ—Ä–º—É–ª–∞:</span>
        <span class="text"
          >3 ¬∑ {floors} + 5 = <strong>{totalHeight}</strong> –º</span
        >
      </div>
      <div class="universal">
        <span>–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å:</span>
        <span class="math-formula">3n + 5</span>
      </div>
    </div>
  </div>
</Section>

<!-- Translator Dictionary -->
<Section
  id="translator-dictionary"
  title="–°–ª–æ–≤–∞—Ä—å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞"
  description="–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Äî —ç—Ç–æ —Å–∏–º–≤–æ–ª, –æ–±–æ–∑–Ω–∞—á–∞—é—â–∏–π –ª—é–±–æ–µ —á–∏—Å–ª–æ –∏–∑ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞. –≠—Ç–æ ¬´–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ¬ª. –í–æ—Ç –∫–∞–∫ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π:"
>
  <div class="grid">
    {#each dictionary as item}
      <div class="row">
        <span class="phrase">{item.phrase}</span>
        <span class="arrow">‚Üí</span>
        <span class="symbol">{item.symbol}</span>
        <span class="desc">{item.desc}</span>
      </div>
    {/each}
  </div>
</Section>

<!-- Live Formula -->
<Section
  id="live-formula"
  title="–ñ–∏–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞"
  description="–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—é –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π. –û–¥–Ω–∞ –ª–∏–Ω–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏—Ç—É–∞—Ü–∏–π."
>
  <div class="demo">
    <div class="selector">
      <button
        class="btn"
        class:active={selectedFormula === "add"}
        onclick={() => (selectedFormula = "add")}
      >
        x + 2
      </button>
      <button
        class="btn"
        class:active={selectedFormula === "multiply"}
        onclick={() => (selectedFormula = "multiply")}
      >
        x √ó 2
      </button>
      <button
        class="btn"
        class:active={selectedFormula === "subtract"}
        onclick={() => (selectedFormula = "subtract")}
      >
        x ‚àí 4
      </button>
    </div>

    <div class="calculator">
      <div class="input-wrapper">
        <label for="var-value">x =</label>
        <input
          id="var-value"
          type="number"
          bind:value={variableValue}
          min="0"
          max="100"
          aria-label="–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π"
        />
      </div>
      <div class="arrow">‚Üí</div>
      <div class="output">
        <span class="label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
        <span class="value">{formulaResult()}</span>
      </div>
    </div>
  </div>
</Section>

<!-- Practice -->
<Section id="practice" title="–ü—Ä–æ–≤–µ—Ä—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ">
  <div class="cards">
    <QuizCard icon="üéÆ" title="–û—á–∫–∏ –≤ –∏–≥—Ä–µ">
      <p>
        –ü–æ—á–µ–º—É –∑–∞–ø–∏—Å—å <span class="math-formula">x + 7</span> –ª—É—á—à–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ
        10, –µ—Å–ª–∏ –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –æ—á–∫–æ–≤ –≤ –∏–≥—Ä–µ?
      </p>
      {#snippet answer()}
        <p>
          –ü–æ—Ç–æ–º—É —á—Ç–æ <span class="math-formula">x + 7</span> ‚Äî —ç—Ç–æ
          <strong>—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ</strong>: –∫–∞–∂–¥–æ–º—É –∏–≥—Ä–æ–∫—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è 7
          –æ—á–∫–æ–≤ –∫ –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —Å–∫–æ–ª—å–∫–æ —É –Ω–µ–≥–æ –±—ã–ª–æ
          –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ.
        </p>
      {/snippet}
    </QuizCard>

    <QuizCard icon="ü§©" title="–°–º–∞–π–ª–∏–∫ –≤ —É—Ä–∞–≤–Ω–µ–Ω–∏–∏">
      <p>
        –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–º–∞–π–ª–∏–∫ ü§© –≤–º–µ—Å—Ç–æ <span class="math-formula"
          >x</span
        > –≤ —É—Ä–∞–≤–Ω–µ–Ω–∏–∏?
      </p>
      {#snippet answer()}
        <p>
          –î–∞! –°–∏–º–≤–æ–ª –Ω–µ –≤–∞–∂–µ–Ω ‚Äî –≤–∞–∂–Ω–∞ –µ–≥–æ <strong>—Ä–æ–ª—å –∫–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞</strong>.
          –ó–∞–ø–∏—Å—å ü§© + 3 = 10 –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞.
        </p>
      {/snippet}
    </QuizCard>

    <QuizCard icon="üë®‚Äçüë¶" title="–û—Ç–µ—Ü –∏ —Å—ã–Ω">
      <p>
        –ï—Å–ª–∏ <span class="math-formula">a</span> ‚Äî –≤–æ–∑—Ä–∞—Å—Ç —Å—ã–Ω–∞, –∞
        <span class="math-formula">b</span> ‚Äî –≤–æ–∑—Ä–∞—Å—Ç –æ—Ç—Ü–∞, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç
        <span class="math-formula">b = a + 25</span>?
      </p>
      {#snippet answer()}
        <p>
          –û—Ç–µ—Ü <strong>—Å—Ç–∞—Ä—à–µ —Å—ã–Ω–∞ –Ω–∞ 25 –ª–µ—Ç</strong>. –≠—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–µ—Ä–Ω–æ –¥–ª—è
          –ª—é–±–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ —Å—ã–Ω–∞ ‚Äî —Ö–æ—Ç—å 5, —Ö–æ—Ç—å 30 –ª–µ—Ç.
        </p>
      {/snippet}
    </QuizCard>
  </div>
</Section>

<Section id="summary">
  <Summary title="–†–µ–∑—é–º–µ">
    <p>
      –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ç–∞–º, –≥–¥–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —á–∏—Å–ª–∞. –ò—Å–ø–æ–ª—å–∑—É—è
      <strong>–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</strong>, –º—ã —Å–æ–∑–¥–∞–µ–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –∑–∞–∫–æ–Ω—ã –∏
      –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤ —Å—Ä–∞–∑—É. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Äî —ç—Ç–æ –Ω–µ
      –∑–∞–≥–∞–¥–∫–∞, —ç—Ç–æ –ø—É—Å—Ç–æ–π –∫–∞—Ä–º–∞–Ω, –≥–æ—Ç–æ–≤—ã–π –ø—Ä–∏–Ω—è—Ç—å –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
    </p>
  </Summary>
</Section>

<style>
  /* Common Math Styles */
  .math-var,
  .math-formula {
    font-family: "Consolas", "Monaco", monospace;
    font-weight: 600;
  }

  .math-var {
    font-size: 1.1em;
    color: var(--color-primary-700);
    background: var(--color-primary-50);
    padding: 0.1em 0.3em;
    border-radius: var(--radius-base);
  }

  .math-formula {
    color: var(--color-primary-800);
  }

  /* Section 1: Crisis (Lazy Architect) */
  :global(#crisis) {
    p {
      margin-bottom: 1rem;
    }

    .calculations {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin: 1.5rem 0;
      padding: 1.5rem;
      background: var(--color-surface-50);
      border-radius: var(--radius-container);
      box-shadow: 0 4px 12px
        color-mix(in oklab, var(--color-surface-900) 0.05, transparent);

      .row {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.25rem;

        .label {
          font-weight: 600;
          color: var(--color-surface-700);
          flex: 0 0 30%;
          width: 30%;
          text-align: left;
        }

        .formula {
          font-family: "Consolas", "Monaco", monospace;
          color: var(--color-primary-700);
          word-break: break-all;
          flex: 1;
        }

        &.problem {
          opacity: 0.6;
          font-style: italic;
        }
      }
    }

    blockquote {
      margin: 1.5rem 0;
      color: var(--color-surface-700);
    }
  }

  /* Section 2: Meaning Container */
  :global(#meaning-container) {
    .conveyor {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin: 2.5rem 0;
      padding: 2rem;
      background: var(--color-surface-100);
      border-radius: calc(var(--radius-container) * 2);
      flex-wrap: wrap;

      .box {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1.5rem 2rem;
        background: var(--color-surface-50);
        border-radius: var(--radius-container);
        box-shadow: 0 4px 6px
          color-mix(in oklab, var(--color-surface-900) 0.05, transparent);
        position: relative;

        &.labeled {
          border: 2px solid var(--color-surface-200);
        }

        &.empty {
          border: 3px dashed var(--color-primary-400);
          background: var(--color-primary-50);

          .value {
            color: var(--color-primary-600);
          }
        }

        .label {
          font-size: 0.875rem;
          color: var(--color-surface-600);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-bottom: 0.5rem;
        }

        .value {
          font-size: 2rem;
          font-weight: 700;
          color: var(--color-surface-900);
        }

        .sticker {
          position: absolute;
          top: -0.75rem;
          right: -0.75rem;
          font-size: 1.5rem;
        }
      }
    }

    .insight {
      font-size: 1.25rem;
      padding: 1.5rem;
      background: var(--color-primary-50);
      border-radius: var(--radius-container);
      border-left: 4px solid var(--color-primary-500);
    }

    @media (max-width: 1100px) {
      .conveyor {
        flex-direction: column;
        padding: 1.5rem;
        gap: 2rem;

        .box {
          width: 100%;
        }
      }
    }
  }

  /* Section 3: Box to Symbol */
  :global(#box-to-symbol) {
    .distillation {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      gap: 2rem;
      margin: 3rem 0;
    }

    .card {
      padding: 2rem;
      border-radius: calc(var(--radius-container) * 1.5);
      height: 100%;
      display: flex;
      flex-direction: column;
      box-shadow: 0 4px 12px
        color-mix(in oklab, var(--color-surface-900) 0.05, transparent);
      transition: transform 0.2s;

      .header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid color-mix(in oklab, currentColor 0.1, transparent);

        .icon {
          font-size: 1.5rem;
        }

        .title {
          font-size: 1rem;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }
      }
    }

    .card.reality {
      background: white;
      border: 1px solid var(--color-surface-200);

      .header {
        color: var(--color-surface-600);
      }

      .content {
        font-family: "Georgia", serif;
        font-size: 1.25rem;
        line-height: 1.6;
        color: var(--color-surface-800);
        font-style: italic;
      }
    }

    .card.math {
      background: var(--color-primary-600);
      color: white;
      border: 1px solid var(--color-primary-700);
      box-shadow: 0 12px 32px
        color-mix(in oklab, var(--color-primary-600) 0.3, transparent);
      justify-content: center;

      .header {
        color: var(--color-primary-100);
        border-bottom-color: var(--color-primary-500);
      }

      .content {
        font-family: "Consolas", "Monaco", monospace;
        font-size: 3.5rem;
        font-weight: 700;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 0.1em;

        .token {
          display: inline-block;
          transition: transform 0.2s;
        }

        .var {
          color: var(--color-warning-300);
        }

        .op {
          color: var(--color-primary-300);
          margin: 0 0.1em;
        }
      }
    }

    .connector {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      color: var(--color-surface-400);

      .arrow-group {
        display: flex;
        align-items: center;
        /* Desktop: Horizontal arrow */
        flex-direction: row;

        .line {
          background: var(--color-surface-300);
          /* Desktop: Horizontal line */
          width: 4rem;
          height: 2px;
        }

        .tip {
          font-size: 1.25rem;
          color: var(--color-surface-300);
          /* Desktop: Point right */
          transform: rotate(-90deg);
          /* Fix alignment visually */
          margin-left: -4px; 
        }
      }

      .badge {
        background: var(--color-surface-200);
        color: var(--color-surface-600);
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        padding: 0.35rem 0.75rem;
        border-radius: 1rem;
        white-space: nowrap;
      }
    }

    @media (max-width: 900px) {
      .distillation {
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }

      .connector {
        flex-direction: row; /* Wrapper row to put badge next to arrow? No, keep column for simplicity first */
        flex-direction: column;
        gap: 0.25rem;

        .arrow-group {
          /* Mobile: Vertical arrow */
          flex-direction: column;
          
          .line {
            /* Mobile: Vertical line */
            width: 2px;
            height: 3rem;
          }

          .tip {
            /* Mobile: Point down */
            transform: rotate(0deg);
            margin-left: 0;
            margin-top: -4px;
          }
        }
      }

      .card.math .content {
        font-size: 3rem;
      }
    }
  }

  /* Section 4: Building Calculator */
  :global(#building-calculator) {
    .demo {
      background: var(--color-surface-100);
      border-radius: calc(var(--radius-container) * 2);
      padding: 2rem;
      display: flex;
      flex-direction: column;
      gap: 2rem;

      .input-group {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
        box-shadow: none;

        label {
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--color-surface-700);
        }

        .range-wrapper {
          flex: 1;
          display: flex;
          align-items: center;
          gap: 1rem;
          min-width: 200px;
          border: none;

          input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: var(--color-surface-300);
            accent-color: var(--color-primary-600);
            cursor: pointer;
            box-shadow: none;
          }

          .value-badge {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-primary-700);
            background: var(--color-surface-50);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-base);
            min-width: 3rem;
            text-align: center;
          }
        }
      }

      .visual {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;

        .part {
          padding: 1rem 1.5rem;
          border-radius: var(--radius-container);
          font-size: 1.125rem;
          display: flex;
          align-items: center;
          gap: 0.75rem;

          &.roof {
            background: var(--color-warning-100);
            border: 2px solid var(--color-warning-300);
            color: var(--color-warning-900);
          }

          &.floors {
            background: var(--color-primary-100);
            border: 2px solid var(--color-primary-300);
            color: var(--color-primary-900);
            min-height: calc(40px + var(--floor-count, 5) * 3px);
            transition: min-height 0.3s ease;

            .icon {
              font-size: 1.5rem;
            }
          }

          &.foundation {
            background: var(--color-surface-200);
            border: 2px solid var(--color-surface-400);
            color: var(--color-surface-800);
          }
        }
      }

      .result {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1.5rem;
        flex-wrap: wrap;
        padding: 1.5rem;
        background: var(--color-surface-50);
        border-radius: var(--radius-container);
        box-shadow: 0 4px 6px
          color-mix(in oklab, var(--color-surface-900) 0.05, transparent);

        .formula-display {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          font-size: 1.25rem;

          .label {
            color: var(--color-surface-600);
          }

          .text {
            font-family: "Consolas", "Monaco", monospace;
            color: var(--color-surface-900);
          }
        }

        .universal {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.75rem 1.25rem;
          background: var(--color-primary-100);
          border-radius: var(--radius-base);
          font-size: 1.25rem;

          .math-formula {
            font-size: 1.5rem;
          }
        }
      }
    }

    @media (max-width: 1100px) {
      .demo {
        padding: 1.5rem;

        .input-group {
          flex-direction: column;
          align-items: stretch;

          .range-wrapper {
            width: 100%;
          }
        }

        .result {
          flex-direction: column;
          text-align: center;
          align-items: stretch;

          .formula-display {
            flex-direction: column;
            text-align: center;
          }

          .universal {
            flex-direction: column;
          }
        }
      }
    }
  }

  /* Section 5: Translator Dictionary */
  :global(#translator-dictionary) {
    .grid {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin: 2rem 0;
    }

    .row {
      display: grid;
      grid-template-columns: minmax(200px, 1.5fr) 40px minmax(60px, auto) 1fr;
      align-items: center;
      gap: 1.5rem;
      padding: 1.5rem 2rem;
      background: var(--color-surface-50);
      border: 1px solid var(--color-surface-200);
      border-radius: var(--radius-container);
      transition: all 0.2s ease;

      &:hover {
        transform: translateY(-2px);
        background: white;
        box-shadow: 0 8px 24px
          color-mix(in oklab, var(--color-primary-500) 0.08, transparent);
        border-color: var(--color-primary-200);
      }

      .phrase {
        font-size: 1.15rem;
        color: var(--color-surface-800);
        font-weight: 500;
      }

      .arrow {
        color: var(--color-surface-400);
        font-size: 1.5rem;
        justify-self: center;
      }

      .symbol {
        font-size: 2rem;
        font-family: "Consolas", "Monaco", monospace;
        font-weight: 700;
        color: var(--color-primary-600);
        justify-self: center;
        width: 3.5rem;
        height: 3.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--color-primary-50);
        border-radius: 50%;
      }

      .desc {
        font-size: 1.1rem;
        color: var(--color-surface-600);
        justify-self: end;
        text-align: right;
      }
    }

    @media (max-width: 900px) {
      .row {
        display: flex;
        flex-direction: column;
        text-align: center;
        gap: 1rem;
        padding: 1.5rem;

        .phrase {
          font-size: 1.25rem;
        }

        .arrow {
          display: none;
        }

        .symbol {
          font-size: 2.5rem;
          width: 5rem;
          height: 5rem;
          background: white;
          border: 2px solid var(--color-primary-100);
        }

        .desc {
          justify-self: center;
          text-align: center;
        }
      }
    }
  }

  /* Section 6: Live Formula */
  :global(#live-formula) {
    .demo {
      background: var(--color-surface-100);
      border-radius: calc(var(--radius-container) * 2);
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2rem;

      .selector {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
        justify-content: center;

        .btn {
          padding: 0.75rem 1.5rem;
          font-size: 1.25rem;
          font-family: "Consolas", "Monaco", monospace;
          border: 2px solid var(--color-surface-300);
          border-radius: var(--radius-container);
          background: var(--color-surface-50);
          cursor: pointer;
          transition: all 0.2s;
          color: var(--color-surface-900);

          &:hover {
            border-color: var(--color-primary-400);
            background: var(--color-primary-50);
          }

          &.active {
            background: var(--color-primary-600);
            color: var(--color-surface-50);
            border-color: var(--color-primary-600);
          }
        }
      }

      .calculator {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        flex-wrap: wrap;
        justify-content: center;

        .input-wrapper {
          display: flex;
          align-items: center;
          gap: 0.5rem;

          label {
            font-size: 1.5rem;
            font-family: "Consolas", "Monaco", monospace;
            font-weight: 600;
            color: var(--color-primary-700);
          }

          input {
            width: 100px;
            padding: 0.75rem;
            font-size: 1.5rem;
            text-align: center;
            border: none;
            border-radius: var(--radius-base);
            background: var(--color-surface-50);
            color: var(--color-surface-900);

            &:focus {
              outline: none;
              border-color: var(--color-primary-500);
              box-shadow: 0 0 0 3px
                color-mix(in oklab, var(--color-primary-500) 0.2, transparent);
            }
          }
        }

        .arrow {
          font-size: 2rem;
          color: var(--color-surface-400);
        }

        .output {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.25rem;

          .label {
            font-size: 0.95rem;
            color: var(--color-surface-600);
          }

          .value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--color-success-700);
            background: var(--color-success-100);
            padding: 0.5rem 1.5rem;
            border-radius: var(--radius-container);
            min-width: 160px;
            text-align: center;
          }
        }
      }
    }

    @media (max-width: 1100px) {
      .demo {
        padding: 1.5rem;

        .calculator {
          flex-direction: column;

          .arrow {
            transform: rotate(90deg);
          }
        }
      }
    }
  }

  /* Section 7: Practice */
  :global(#practice) {
    .cards {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
  }
</style>
